<?xml version="1.0"?>

<!-- gigatron.launch
     Launch file for Gigatron hardware

     @author  Syler Wagner  <syler@mit.edu>
     
     @date    2016-08-17    syler   creation
    -->

<launch>

	<arg name="semiautomatic" default="true" doc="true for autonomous steering with RC throttle" />

	<arg name="car" value="gigatron" />
	<arg name="rviz" default="false" /> <!-- display robot in RViz -->
	<arg name="gps" default="true" doc="using GPS sensor or no?" />
<!-- 	<arg name="back_lidar" default="false" doc="using rear LIDAR or no?"/>
 -->
	<!-- URDF model with robot state publisher -->
	<include file="$(find gigatron_hardware)/launch/xacro.launch" >
		<arg name="car" value="$(arg car)" />
	</include>

	<!-- car launch file -->
	<include file="$(find gigatron_hardware)/launch/car.launch" >
		<arg name="car" value="$(arg car)" />
		<arg name="semiautomatic" value="$(arg semiautomatic)" />
		<arg name="rviz" value="$(arg rviz)" />
		<arg name="gps" value="$(arg gps)" />
		<arg name="zed" default="true" doc="using ZED sensor or no?" />
	</include>
	<!-- ZED laser scans -->
	<include if="$(optenv NVIDIA_JETSON_TX1 false)" file="$(find gigatron_hardware)/launch/sensors/zed_scan.launch" />

	<group ns="zed">
		<node name="scan_relay" type="relay" pkg="topic_tools" args="scan /scan"/>
	</group>

	<!-- launch LIDARs except on TX1 -->
	<group unless="$(optenv NVIDIA_JETSON_TX1 false)">
	
		<!-- front LIDAR  -->
		<include file="$(find gigatron_hardware)/launch/sensors/rplidar.launch"/>
		<group ns="rplidar">
		<include file="$(find scan_filters)/launch/angle_filter.launch" >
	    	<arg name="filter_name" value="angle_filter" />
	    	<arg name="config" value="inverted_laser_angle_filter_forward_180_degrees" />
	    	<arg name="input_topic" value="scan" />
	    	<arg name="output_topic" value="scan/forward" /> 
		</include>
		<node name="scan_relay" type="relay" pkg="topic_tools" args="scan/forward /scan"/>
		</group>
	 
		<!-- front bottom LIDAR  -->
		<include file="$(find gigatron_hardware)/launch/sensors/xvlidar.launch"/>
		<group ns="xvlidar">
			<include file="$(find scan_filters)/launch/angle_filter.launch" >
	    	<arg name="filter_name" value="angle_filter" />
	    	<arg name="config" value="laser_angle_filter_forward_180_degrees" />
	    	<arg name="input_topic" value="scan" />
	    	<arg name="output_topic" value="scan/forward" />
		</include>
		<node name="scan_relay" type="relay" pkg="topic_tools" args="scan/forward /scan"/>
		</group>

	</group>

</launch>
